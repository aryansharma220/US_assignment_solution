{% extends "base.html" %}

{% block title %}Home - ShopSmart AI{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="hero">
    <div class="container">
        <div class="hero-content">
            <h1 class="hero-title">
                <i class="fas fa-sparkles"></i>
                AI-Powered Product Recommendations
            </h1>
            <p class="hero-subtitle">
                Discover products tailored to your preferences using advanced machine learning 
                and natural language explanations powered by Google Gemini
            </p>
            <div class="hero-buttons">
                <a href="{{ url_for('recommendations_page') }}" class="btn btn-primary btn-lg">
                    <i class="fas fa-star"></i> Get Recommendations
                </a>
                <a href="{{ url_for('products_page') }}" class="btn btn-secondary btn-lg">
                    <i class="fas fa-box"></i> Browse Products
                </a>
            </div>
            
            <!-- System Status -->
            <div class="status-badge" id="systemStatus">
                <i class="fas fa-spinner fa-spin"></i> Checking system status...
            </div>
        </div>
    </div>
</section>

<!-- Features Section -->
<section class="features">
    <div class="container">
        <h2 class="section-title">How It Works</h2>
        <div class="features-grid">
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-users"></i>
                </div>
                <h3>Collaborative Filtering</h3>
                <p>Finds users with similar taste and recommends products they loved</p>
            </div>
            
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-tag"></i>
                </div>
                <h3>Content-Based</h3>
                <p>Matches products to your preferences based on categories, brands, and features</p>
            </div>
            
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-magic"></i>
                </div>
                <h3>Hybrid Algorithm</h3>
                <p>Combines multiple strategies for the most accurate recommendations</p>
            </div>
            
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-brain"></i>
                </div>
                <h3>AI Explanations</h3>
                <p>Understand why each product is recommended with natural language explanations</p>
            </div>
        </div>
    </div>
</section>

<!-- Stats Section -->
<section class="stats">
    <div class="container">
        <h2 class="section-title">Database Statistics</h2>
        <div class="stats-grid" id="statsGrid">
            <div class="stat-card">
                <i class="fas fa-spinner fa-spin"></i>
                <p>Loading...</p>
            </div>
        </div>
    </div>
</section>

<!-- CTA Section -->
<section class="cta">
    <div class="container">
        <div class="cta-content">
            <h2>Ready to Discover Amazing Products?</h2>
            <p>Get personalized recommendations powered by AI</p>
            <a href="{{ url_for('recommendations_page') }}" class="btn btn-primary btn-lg">
                <i class="fas fa-rocket"></i> Start Now
            </a>
        </div>
    </div>
</section>
{% endblock %}

{% block extra_scripts %}
<script>
    // Load system status
    async function loadSystemStatus() {
        try {
            const response = await fetch('/api/gemini/test');
            const data = await response.json();
            const statusBadge = document.getElementById('systemStatus');
            
            if (data.status === 'success' && data.data.available) {
                statusBadge.innerHTML = '<i class="fas fa-check-circle"></i> Gemini AI: Active';
                statusBadge.classList.add('status-active');
            } else {
                statusBadge.innerHTML = '<i class="fas fa-info-circle"></i> Fallback Mode: Active';
                statusBadge.classList.add('status-fallback');
            }
        } catch (error) {
            const statusBadge = document.getElementById('systemStatus');
            statusBadge.innerHTML = '<i class="fas fa-exclamation-circle"></i> Status: Unknown';
            statusBadge.classList.add('status-error');
        }
    }

    // Load statistics
    async function loadStats() {
        try {
            const response = await fetch('/api/stats');
            const data = await response.json();
            
            if (data.status === 'success') {
                const stats = data.data;
                const statsGrid = document.getElementById('statsGrid');
                
                statsGrid.innerHTML = `
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-box"></i></div>
                        <div class="stat-number">${stats.products.total}</div>
                        <div class="stat-label">Products</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-users"></i></div>
                        <div class="stat-number">${stats.users.total}</div>
                        <div class="stat-label">Users</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-shopping-cart"></i></div>
                        <div class="stat-number">${stats.interactions.purchases}</div>
                        <div class="stat-label">Purchases</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-eye"></i></div>
                        <div class="stat-number">${stats.interactions.views}</div>
                        <div class="stat-label">Views</div>
                    </div>
                `;
            }
        } catch (error) {
            console.error('Error loading stats:', error);
        }
    }

    // Initialize
    document.addEventListener('DOMContentLoaded', () => {
        loadSystemStatus();
        loadStats();
    });
</script>
{% endblock %}
